<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Digital Clock</title>
    <style>
        /* 기본 초기화 */
        body {
            background-color: #000000;
            margin: 0;
            padding: 0;
            /* 세로 중앙 정렬을 위한 핵(hack) */
            height: 1200px;
            text-align: center;
        }

        html {
            height: 100%;
        }

        /* 중앙 컨테이너 */
        #container {
            height: 100%;
            width: 100%;
            /* 구버전 브라우저에서 수직 중앙 정렬을 위한 테이블 방식 */
            display: table;
        }

        .center-wrapper {
            display: table-cell;
            vertical-align: middle;
        }

        /* 시계 영역 (파란색 큰 글씨) */
        .clock-time {
            display: inline-block;
            color: #7daaf2; /* 이미지의 하늘색과 유사한 색상 */
            font-size: 320px; /* 매우 큰 사이즈 */
            line-height: 1;
            letter-spacing: -5px; /* 자간을 좁게 */
            vertical-align: top;
            margin-right: 20px;
            font-weight: 900;
        }

        /* 날짜 및 온도 영역 (오른쪽 정보) */
        .info-box {
            display: inline-block;
            text-align: left;
            vertical-align: top;
            padding-top: 20px; /* 시간 숫자 높이와 시각적 균형 맞춤 */
        }

        .date-text {
            color: #ffffff;
            font-size: 40px;
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .temp-text {
            color: #ffffff;
            font-size: 40px;
            font-weight: bold;
            display: block;
        }

        .aqi-text {
            color: #ffffff;
            font-size: 30px;
            font-weight: bold;
            display: block;
            margin-top: 10px;
        }

        .forecast-text {
            color: #dddddd;
            font-size: 20px;
            font-weight: normal;
            display: block;
            margin-top: 5px;
        }

        /* 깜빡이는 콜론 효과 */
        .blink {
            animation: blinker 1s linear infinite;
            /* 구버전 크롬(-webkit-) 호환 */
            -webkit-animation: blinker 1s linear infinite;
        }

        @keyframes blinker {
            50% { opacity: 0; }
        }
        @-webkit-keyframes blinker {
            50% { opacity: 0; }
        }

        /* 특별 메시지 스타일 */
        .special-message {
            display: none; /* 기본 숨김 */
            font-size: 80px;
            color: #ff69b4; /* 핑크색 포인트 */
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div id="container">
        <div class="center-wrapper">
            <div class="clock-time" id="timeDisplay">10<span class="blink">:</span>30</div>
            
            <div class="info-box">
                <div class="date-text" id="dateDisplay">16일 (월)</div>
                <div class="temp-text" id="secondsDisplay">00초</div>
                <div class="aqi-text" id="aqiDisplay"></div>
                <div class="forecast-text" id="forecastDisplay"></div>
                <div class="forecast-text" id="forecastTomorrowDisplay"></div>
            </div>
            <div id="specialMessage" class="special-message">윤은솔 예쁜이</div>
        </div>
    </div>

    <script>
        // ES5 문법 사용 (구버전 호환)
        function updateClock() {
            var now = new Date();
            
            // 시간 추출
            var hours = now.getHours();
            var minutes = now.getMinutes();
            var seconds = now.getSeconds();

            // 매 초마다 색상 변경 (밝은 색 계열)
            var colors = ['#FF80AB', '#EA80FC', '#8C9EFF', '#80D8FF', '#A7FFEB', '#CCFF90', '#FFFF8D', '#FFD180'];
            document.getElementById('timeDisplay').style.color = colors[seconds % colors.length];
            
            // 2자리 숫자로 맞추기 (예: 9 -> 09)
            hours = hours < 10 ? '0' + hours : hours;
            minutes = minutes < 10 ? '0' + minutes : minutes;
            var strSeconds = seconds < 10 ? '0' + seconds : seconds;
            
            // 시간 표시 업데이트
            var timeString = hours + '<span class="blink">:</span>' + minutes;
            document.getElementById('timeDisplay').innerHTML = timeString;

            // 날짜 추출
            var date = now.getDate();
            var dayIndex = now.getDay();
            var dayNames = ['일', '월', '화', '수', '목', '금', '토'];
            var dayName = dayNames[dayIndex];

            // 날짜 표시 업데이트
            // 색상 강조를 위해 괄호 안 요일은 별도 스타일링 가능하나 이미지대로 흰색 유지
            var dateString = date + '일 (' + dayName + ')';
            document.getElementById('dateDisplay').innerHTML = dateString;
            
            // 초 표시 업데이트
            document.getElementById('secondsDisplay').innerHTML = strSeconds + '';

            // 매시 30분 0초 ~ 29초 동안 메시지 표시
            var messageDiv = document.getElementById('specialMessage');
            if (minutes % 10 === 0) {
                messageDiv.style.display = 'block';
            } else {
                messageDiv.style.display = 'none';
            }
        }

        function updateAQI() {
            var token = 'c1611aa54ac7de2320cc3105b7b42a0ba2b26447';
            // 'here'는 IP 기반으로 현재 위치를 자동으로 찾습니다.
            var url = 'https://api.waqi.info/feed/here/?token=' + token;

            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    try {
                        var response = JSON.parse(xhr.responseText);
                        if (response.status === 'ok') {
                            var aqi = response.data.aqi;
                            var statusText = '좋음';
                            if (aqi > 50) statusText = '보통';
                            if (aqi > 100) statusText = '나쁨';
                            if (aqi > 150) statusText = '매우나쁨';
                            
                            document.getElementById('aqiDisplay').innerHTML = 'PM 2.5: ' + aqi + ' (' + statusText + ')';

                            // 오늘 예보 (최저/최고) 가져오기
                            if (response.data.forecast && response.data.forecast.daily && response.data.forecast.daily.pm25) {
                                var forecasts = response.data.forecast.daily.pm25;
                                var now = new Date();
                                var year = now.getFullYear();
                                var month = now.getMonth() + 1;
                                var day = now.getDate();
                                if (month < 10) month = '0' + month;
                                if (day < 10) day = '0' + day;
                                var todayStr = year + '-' + month + '-' + day;

                                var tomorrow = new Date(now);
                                tomorrow.setDate(tomorrow.getDate() + 1);
                                var tYear = tomorrow.getFullYear();
                                var tMonth = tomorrow.getMonth() + 1;
                                var tDay = tomorrow.getDate();
                                if (tMonth < 10) tMonth = '0' + tMonth;
                                if (tDay < 10) tDay = '0' + tDay;
                                var tomorrowStr = tYear + '-' + tMonth + '-' + tDay;

                                for (var i = 0; i < forecasts.length; i++) {
                                    if (forecasts[i].day === todayStr) {
                                        document.getElementById('forecastDisplay').innerHTML = '오늘: 최저 [' + forecasts[i].min + '] 최고 [' + forecasts[i].max + ']';
                                    }
                                    if (forecasts[i].day === tomorrowStr) {
                                        document.getElementById('forecastTomorrowDisplay').innerHTML = '내일: 최저 [' + forecasts[i].min + '] 최고 [' + forecasts[i].max + ']';
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.log('AQI Error');
                    }
                }
            };
            xhr.send();
        }

        // 1초마다 실행
        setInterval(updateClock, 1000);
        
        // 페이지 로드 시 즉시 실행
        updateClock();
        updateAQI();
        // 30분마다 미세먼지 정보 갱신
        setInterval(updateAQI, 1800000);
    </script>
</body>
</html>
